# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# dnaorg_annotate_genomes.pl: Annotate genomes based on a reference and homology search
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# command: dnaorg_annotate_genomes.pl -oseq TAATATT|AC -skipbuild -seqcol -skipfetch -skipaln  NC_001346 NC_001346.ntlist
# date:    Tue Oct  6 09:43:19 2015
# option:  searching for origin sequence of TAATATT|AC [-oseq]
# option:  skipping the build step [-skipbuild]
# option:  forcing seqs-as-columns output mode [-seqcol]
# option:  use existing fetched genome file, don't create a new one [-skipfetch]
# option:  use existing cmscan/hmmscan and alignment results, don't actually run either [-skipaln]
#
# Skipping genome fetch step                                      ... done. [-skipfetch]
# Fetching reference CDS sequences                                ... done. [0.3 seconds]
# Validating CM file was built from correct alignment files       ... done. [0.0 seconds]
# Skipping cmscan step                                            ... done. [-skipscan or -skipaln]
# Skipping fetch of predicted exons                               ... done. [-skipaln]
# Combining multi-exon predicted CDS                              ... done. [0.0 seconds]
# Translating predicted CDS to identify internal starts/stops     ... done. [0.0 seconds]
# Skipping fetch of corrected exons                               ... done. [-skipaln]
# Combining multi-exon corrected CDS                              ... done. [0.0 seconds]
# Skipping multiple alignment creation                            ... done. [-skipaln]
#
idx                                                                                  1                    2                    3                    4                    5
accession                                                                    NC_001346             KJ699341             KJ437659             HQ693446             HQ693435
totlen                                                                            2689                 2689                 2689                 2690                 2690
origin sequence:#                                                                    1                    1                    1                    1                    1
origin sequence:start                                                               -7                 2534                 2534                 2535                 2535
origin sequence:stop                                                                 2                 2542                 2542                 2543                 2543
origin sequence:offst                                                                0                  149                  149                  149                  149
origin sequence:PF                                                                   P                    P                    P                    P                    P
CDS #1 [single exon; +]:movement protein:start1                                    150                    1                    1                    1                    1
CDS #1 [single exon; +]:movement protein:stop1                                     455                  306                  306                  306                  306
CDS #1 [single exon; +]:movement protein:fid1                                    1.000                1.000                0.993                0.974                0.980
CDS #1 [single exon; +]:movement protein:md1                                        ..                   ..                   ..                   ..                   ..
CDS #1 [single exon; +]:movement protein:length                                    306                  306                  306                  306                  306
CDS #1 [single exon; +]:movement protein:ss3                                       ...                  ...                  ...                  ...                  ...
CDS #1 [single exon; +]:movement protein:stp                                       TAA                  TAA                  TAA                  TAA                  TAA
CDS #1 [single exon; +]:movement protein:PF                                          P                    P                    P                    P                    P
CDS #2 [single exon; +]:capsid protein:start1                                      466                  317                  317                  317                  317
CDS #2 [single exon; +]:capsid protein:stop1                                      1200                 1051                 1051                 1051                 1051
CDS #2 [single exon; +]:capsid protein:fid1                                      1.000                0.992                0.993                0.971                0.971
CDS #2 [single exon; +]:capsid protein:md1                                          ..                   ..                   ..                   ..                   ..
CDS #2 [single exon; +]:capsid protein:length                                      735                  735                  735                  735                  735
CDS #2 [single exon; +]:capsid protein:ss3                                         ...                  ...                  ...                  ...                  ...
CDS #2 [single exon; +]:capsid protein:stp                                         TAA                  TAA                  TAA                  TAA                  TAA
CDS #2 [single exon; +]:capsid protein:PF                                            P                    P                    P                    P                    P
CDS #3 [2 exons; -]:replication-associated protein:start1                         2527                 2378                 2378                 2379                 2379
CDS #3 [2 exons; -]:replication-associated protein:stop1                          1886                 1737                 1737               [1738]               [1738]
CDS #3 [2 exons; -]:replication-associated protein:fid1                          1.000                0.992                0.991                0.988                0.984
CDS #3 [2 exons; -]:replication-associated protein:md1                              ..                   ..                   ..                   ..                   ..
CDS #3 [2 exons; -]:replication-associated protein:start2                         1793                 1644                 1644               [1645]               [1645]
CDS #3 [2 exons; -]:replication-associated protein:stop2                          1353                 1204                 1204               [1220]               [1220]
CDS #3 [2 exons; -]:replication-associated protein:fid2                          1.000                0.991                0.973                0.974                0.974
CDS #3 [2 exons; -]:replication-associated protein:md2                              ..                   ..                   ..                   .c                   .c
CDS #3 [2 exons; -]:replication-associated protein:length                         1083                 1083                 1083                 1068                 1068
CDS #3 [2 exons; -]:replication-associated protein:ss3                             ...                  ...                  ...                  ...                  ...
CDS #3 [2 exons; -]:replication-associated protein:stp                             TGA                  TGA                  TGA                  TAA                  TAA
CDS #3 [2 exons; -]:replication-associated protein:PF                                P                    P                    P                    P                    P
CDS #4 [single exon; -]:replication-associated protein A:start1                   2527                 2378                 2378                 2379                 2379
CDS #4 [single exon; -]:replication-associated protein A:stop1                    1709                 1560                 1560                 1561                 1561
CDS #4 [single exon; -]:replication-associated protein A:fid1                    1.000                0.993                0.980                0.987                0.984
CDS #4 [single exon; -]:replication-associated protein A:md1                        ..                   ..                   ..                   ..                   ..
CDS #4 [single exon; -]:replication-associated protein A:length                    819                  819                  819                  819                  819
CDS #4 [single exon; -]:replication-associated protein A:ss3                       ...                  ...                  ...                  ...                  ...
CDS #4 [single exon; -]:replication-associated protein A:stp                       TAG                  TAG                  TAG                  TAG                  TAG
CDS #4 [single exon; -]:replication-associated protein A:PF                          P                    P                    P                    P                    P
totlen                                                                            2689                 2689                 2689                 2690                 2690
avgid                                                                            1.000                0.994                0.986                0.979                0.979
GenBank annotation:cds                                                               4                    4                    4                    3                    3
GenBank annotation:exons                                                             5                    5                    5                    3                    3
GenBank annotation:match                                                            10                   10                   10                    7                    7
overlaps?                                                          P 2 3.1/4.1,3.2/4.1  P 2 3.1/4.1,3.2/4.1  P 2 3.1/4.1,3.2/4.1  P 2 3.1/4.1,3.2/4.1  P 2 3.1/4.1,3.2/4.1
result                                                                      PASS PPPPP           PASS PPPPP           PASS PPPPP           PASS PPPPP           PASS PPPPP
#
# end of page 1
#
#
# Explanations of column headings (in left to right order):
# "idx":                              index of genome in list
# "accession":                        GenBank accession for genomic sequence
# "totlen":                           total length (nt) for accession
#
# "origin sequence: #":               number of occurences of origin sequence (input with -oseq) in genome
# "origin sequence: start":           start position of lone occurence of origin sequence (if only 1 exists)
# "origin sequence: stop":            stop  position of lone occurence of origin sequence (if only 1 exists)
# "origin sequence: offst":           predicted offset of genome, number of nucleotides to shift start (>0: clockwise; <0: counterclockwise)
# "origin sequence: PF":              'P' (for PASS) if there is exactly 1 occurence of the offset, else 'F' for FAIL
#
# "CDS #<i>: start<j>":               start position of exon #<j> of CDS #<i>enclosed in brackets "[]" if different from all exon starts in existing GenBank annotation
# "CDS #<i>: stop<j>":                stop  position of exon #<j> of CDS #<i>enclosed in brackets "[]" if different from all exon starts in existing GenBank annotation
# "CDS #<i>: fid<j>":                 fractional identity between exon #<j> of CDS #<i> and reference genome
# "CDS #<i>: md<j>":                  annotation indicating if alignment to reference extends to 5' and 3' end of reference exon.
#                                     first character pertains to 5' end and second character pertains to 3' end.
#                                     possible values for each of the two characters:
#                                       ".":   alignment extends to boundary of reference
#                                       "<d>": alignment truncates <d> nucleotides short of boundary of reference (1 <= <d> <= 9)
#                                       "+":   alignment truncates >= 10 nucleotides short of boundary of reference
# "CDS #<i>: length":                 length of CDS #<i> (all exons summed)
#
# "CDS #<i>: SS3":                    annotation indicating if predicted CDS has a valid start codon, stop codon and is a multiple of 3
#                                     first  character: '.' if predicted CDS has a valid start codon, else '!'
#                                     second character: '.' if predicted CDS has a valid stop  codon, else '!'
#                                     third  character: '.' if predicted CDS has a length which is a multiple of three, else '!'
# "CDS #<i>: stp":                    the predicted stop codon for this CDS
# "CDS #<i>: PF":                     annotation indicating if this exon PASSED ('P') or FAILED ('F')
#                                       a CDS PASSES ('P') if and only if ALL of its exons have a valid start codon,
#                                       a valid stop codon, are lengths that are a multiple of 3, and have an
#                                       alignment to the corresponding reference exon that extends to the 5'
#                                       and 3' boundary of the reference annotation.
#                                       If >= 1 of these conditions is not met then the CDS FAILS ('F').
#
# "totlen":                           total length (nt) for accession (repeated for convenience)
#
# "GenBank annotation: cds"           number of CDS in the existing GenBank annotation for this accession
# "GenBank annotation: exons"         total number of exons in the existing GenBank annotation for this accession
# "GenBank annotation: match"         number of exons in existing GenBank annotation for which existing and predicted annotation agree exactly
#
# "overlaps?"                         text describing which (if any) of the predicted exons overlap with each other
#                                     first character:   'P' for PASS if predicted annotation for this accession has same overlaps as the reference
#                                                        'F' for FAIL if it does not
#                                     second character:  number of overlaps between any two exons
#                                     remainder of line: text explaining which exons overlap
#                                       e.g.: "3.2/4.1" indicates exon #2 of CDS #3 overlaps with exon #1 of CDS #4 on either strand
#
# "result":                           "PASS" or "FAIL". "PASS" if and only if all tests for this accession PASSED ('P')
#                                     as indicated in the "PF" columns. Followed by the individual P/F results in order.
